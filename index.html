<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <title>SAD test</title>
    
  </head>
  <body>
    <script>
      const env = {
        memoryBase: 0,
        tableBase: 0,
        memory: new WebAssembly.Memory({ initial: 256 }),
        table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' }),
      };

      fetch('sad.wasm')
        .then(response => response.arrayBuffer())
        .then(bytes => WebAssembly.instantiate(bytes, { env: env }))
        .then(results => {
          const { instance } = results;
          const data = new Uint8Array(instance.exports.mem.buffer);

          console.log(data);

          window.SAD = (A, B) => {
            data.set(A, 0);
            data.set(B, A.length);
            return instance.exports.sad(0, A.length, A.length);
          };
        });
    </script>
  </body>
</html>
